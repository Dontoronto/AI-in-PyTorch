2024-03-20 23:03:56,575 - modelWrapper - INFO - ModelWrapper was initialized
2024-03-20 23:03:56,576 - dataHandler - INFO - Datahandler initialized
2024-03-20 23:03:56,577 - configParser - INFO - Transformation Parameters from DataHandlerConfig.json:
2024-03-20 23:03:56,577 - configParser - INFO - {'dtype': 'float', 'normalize': {'mean': [0.1307], 'std': [0.3081]}}
2024-03-20 23:03:56,577 - configurator - INFO - DataHandlerConfig was loaded via ConfigParser
2024-03-20 23:03:56,577 - configurator - INFO - Preprocessing dtype is set so: float
2024-03-20 23:03:56,577 - configurator - INFO - Preprocessing Normalization is activated
2024-03-20 23:03:56,577 - configurator - INFO - Preprocessing Normalization std is set to: [0.3081]
2024-03-20 23:03:56,578 - configurator - INFO - Preprocessing Normalization mean is set to: [0.1307]
2024-03-20 23:03:56,578 - configurator - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,578 - dataHandler - INFO - Preprocessing Steps will be:
2024-03-20 23:03:56,578 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,578 - configurator - INFO - DataHandlerConfig was loaded via ConfigParser
2024-03-20 23:03:56,578 - configurator - INFO - Preprocessing dtype is set so: float
2024-03-20 23:03:56,579 - configurator - INFO - Preprocessing Normalization is activated
2024-03-20 23:03:56,579 - configurator - INFO - Preprocessing Normalization std is set to: [0.3081]
2024-03-20 23:03:56,579 - configurator - INFO - Preprocessing Normalization mean is set to: [0.1307]
2024-03-20 23:03:56,579 - configurator - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,579 - dataHandler - INFO - Preprocessing Steps will be:
2024-03-20 23:03:56,579 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,580 - configParser - INFO - Trainer Configs from TrainerConfig.json:
2024-03-20 23:03:56,580 - configParser - INFO - {'optimizer': 'Adam', 'loss': 'CrossEntropyLoss', 'epoch': 25, 'lr': 0.001, 'momentum': 0.9, 'pre_optimization_tuning_path': True}
2024-03-20 23:03:56,580 - configurator - INFO - TrainerConfig settings was loaded via ConfigParser
2024-03-20 23:03:56,580 - Trainer.trainerFactory - INFO - Filtered OptimizerConfig: {'lr': 0.001}
2024-03-20 23:03:56,705 - Trainer.trainerFactory - INFO - Creating ADMMTrainer.
2024-03-20 23:03:56,705 - Trainer.defaultTrainer - INFO - Trainer was configured
2024-03-20 23:03:56,705 - Trainer.defaultTrainer - INFO - Epochs: 25
2024-03-20 23:03:56,705 - Trainer.defaultTrainer - INFO - Optimizer: Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)
2024-03-20 23:03:56,705 - Trainer.defaultTrainer - INFO - Lossfunction: CrossEntropyLoss()
2024-03-20 23:03:56,706 - Trainer.defaultTrainer - INFO - DataHandler: <dataHandler.DataHandler object at 0x168188790>
2024-03-20 23:03:56,706 - configParser - INFO - Dataloader Configs from TrainerConfig.json:
2024-03-20 23:03:56,706 - configParser - INFO - {'batch_size': 32, 'shuffle': True, 'num_workers': 1}
2024-03-20 23:03:56,706 - configurator - INFO - Dataloader settings was loaded via ConfigParser
2024-03-20 23:03:56,706 - configParser - INFO - Snapshot Configs from TrainerConfig.json:
2024-03-20 23:03:56,706 - configParser - INFO - {'name': 'LeNet_epsiolon_test', 'snapshot_enabled': False, 'snapshot_model_path': 'models/LeNet/', 'snapshot_model_path_raw': 'models/LeNet/', 'recovery_epoch': 3}
2024-03-20 23:03:56,706 - configurator - INFO - Snapshot settings was loaded via ConfigParser
2024-03-20 23:03:56,706 - Trainer.defaultTrainer - INFO - Recovery Epoch was set to : False
2024-03-20 23:03:56,707 - Trainer.defaultTrainer - INFO - Model file prefix was set to : LeNet_epsiolon_test
2024-03-20 23:03:56,707 - Trainer.defaultTrainer - INFO - Snapshot model path was set to : models/LeNet/
2024-03-20 23:03:56,707 - Trainer.defaultTrainer - INFO - Snapshot model path was set to : models/LeNet/
2024-03-20 23:03:56,707 - Trainer.defaultTrainer - INFO - Recovery Epoch was set to : 3
2024-03-20 23:03:56,707 - configParser - INFO - Loaded admm_model_architecture from ConfigRegistry.json
2024-03-20 23:03:56,707 - configParser - INFO - Loaded admm_model_architecture has path: configs/preOptimizingTuning/ADMMModelArchitecture.json
2024-03-20 23:03:56,707 - configParser - INFO - Loaded admm_model_architecture
2024-03-20 23:03:56,708 - configurator - INFO - Loaded admm_model_architecture from Registry
2024-03-20 23:03:56,708 - Trainer.mapper.admm_mapper - INFO - ADMM Architecture Config was loaded into ADMMTrainer
2024-03-20 23:03:56,708 - configParser - INFO - Loaded admm_settings from ConfigRegistry.json
2024-03-20 23:03:56,708 - configParser - INFO - Loaded admm_settings has path: configs/preOptimizingTuning/ADMMConfig.json
2024-03-20 23:03:56,708 - configParser - INFO - Loaded admm_settings
2024-03-20 23:03:56,709 - configurator - INFO - Loaded admm_settings from Registry
2024-03-20 23:03:56,709 - Trainer.mapper.admm_mapper - INFO - ADMM Config was loaded into ADMMTrainer
2024-03-20 23:03:56,709 - Trainer.mapper.admm_mapper - INFO - main_iterations set to 320000 of type <class 'int'>
2024-03-20 23:03:56,709 - Trainer.mapper.admm_mapper - INFO - admm_iterations set to 2000 of type <class 'int'>
2024-03-20 23:03:56,709 - Trainer.mapper.admm_mapper - INFO - dynamic masking set to True of type <class 'bool'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - rho set to 0.0001 of type <class 'float'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - gradient_threshold set to 6 of type <class 'int'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - batch_size_norm_coeff set to 0.03125 of type <class 'float'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - regularization_l2_norm_enabled set to True of type <class 'bool'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - regularization_l_norm_decay set to 5e-06 of type <class 'float'>
2024-03-20 23:03:56,710 - Trainer.mapper.admm_mapper - INFO - Phase list set to ['admm', 'retrain'] of type <class 'list'>
2024-03-20 23:03:56,711 - Trainer.mapper.admm_mapper - INFO - save set to False of type <class 'bool'>
2024-03-20 23:03:56,711 - Trainer.mapper.admm_mapper - INFO - epsilon_W set to 1 of type <class 'int'>
2024-03-20 23:03:56,711 - Trainer.mapper.admm_mapper - INFO - epsilon_Z set to 1 of type <class 'int'>
2024-03-20 23:03:56,711 - configParser - INFO - Dataset Configs from DataHandlerConfig.json:
2024-03-20 23:03:56,711 - configParser - INFO - {'datasetName': 'mnist', 'storageType': 'default', 'root': '/Users/dominik/Documents/jupyter/Neuronale Netze programmieren Buch/AI in PyTorch/dataset/mnist/', 'query': ['Volumes', 'PortableSSD', 'Projekte', 'datasets', 'celeba_dataset', 'IMG', 'img_align_celeba'], 'download': True, 'transform': True, 'target_transform': None}
2024-03-20 23:03:56,712 - configurator - INFO - DatasetConfig was loaded via ConfigParser
2024-03-20 23:03:56,712 - IOComponent.datasetFactory - INFO - Creating preconfigured Dataset for MNIST
2024-03-20 23:03:56,726 - dataHandler - INFO - Transformer of Dataset was changed to:
2024-03-20 23:03:56,726 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,727 - dataHandler - INFO - Transformer of Dataset was changed to:
2024-03-20 23:03:56,727 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,727 - dataHandler - INFO - Transformer loaded into Dataset
2024-03-20 23:03:56,727 - Trainer.defaultTrainer - INFO - Dataset was loaded in Trainer class
2024-03-20 23:03:56,728 - Trainer.defaultTrainer - INFO - Labels of Dataset are in the correct form to be processed with CrossEntropyLoss()
2024-03-20 23:03:56,728 - configurator - INFO - DatasetConfig was loaded via ConfigParser
2024-03-20 23:03:56,728 - IOComponent.datasetFactory - INFO - Creating preconfigured Dataset for MNIST
2024-03-20 23:03:56,730 - dataHandler - INFO - Transformer of Dataset was changed to:
2024-03-20 23:03:56,731 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,731 - dataHandler - INFO - Transformer of Testset was changed to:
2024-03-20 23:03:56,731 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,731 - dataHandler - INFO - Transformer loaded into Testset
2024-03-20 23:03:56,731 - Trainer.defaultTrainer - INFO - Testet was loaded in Trainer class
2024-03-20 23:03:56,731 - Trainer.defaultTrainer - INFO - Created Dataloader with settings: {'batch_size': 32, 'shuffle': True, 'num_workers': 1}
2024-03-20 23:03:56,732 - configurator - INFO - DatasetConfig was loaded via ConfigParser
2024-03-20 23:03:56,732 - IOComponent.datasetFactory - INFO - Creating preconfigured Dataset for MNIST
2024-03-20 23:03:56,735 - dataHandler - INFO - Transformer of Dataset was changed to:
2024-03-20 23:03:56,735 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,736 - dataHandler - INFO - Transformer of Testset was changed to:
2024-03-20 23:03:56,736 - dataHandler - INFO - Compose(
    ToTensor()
    ConvertImageDtype()
    Normalize(mean=[0.1307], std=[0.3081])
)
2024-03-20 23:03:56,736 - dataHandler - INFO - Transformer loaded into Testset
2024-03-20 23:03:56,754 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 100.0
2024-03-20 23:03:56,756 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 99.99996185302734
2024-03-20 23:03:56,757 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 99.99909210205078
2024-03-20 23:03:56,759 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 100.0
2024-03-20 23:03:56,760 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 99.99996948242188
2024-03-20 23:03:56,761 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 100.0
2024-03-20 23:03:56,763 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 100.0
2024-03-20 23:03:56,764 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 99.99999237060547
2024-03-20 23:03:56,766 - analyzer.measurement.topPredictions - INFO - TopK prediction of first 3 values: 99.99994659423828
2024-03-20 23:03:56,987 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv1, Zero weights: 0/54 (0.00%)
2024-03-20 23:03:56,987 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv2, Zero weights: 0/864 (0.00%)
2024-03-20 23:03:56,987 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc1, Zero weights: 0/94080 (0.00%)
2024-03-20 23:03:56,994 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc2, Zero weights: 0/10080 (0.00%)
2024-03-20 23:03:56,994 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc3, Zero weights: 0/840 (0.00%)
2024-03-20 23:03:56,995 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv1, Zero weights: 0/54 (0.00%)
2024-03-20 23:03:56,995 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv2, Zero weights: 0/864 (0.00%)
2024-03-20 23:03:56,996 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc1, Zero weights: 0/94080 (0.00%)
2024-03-20 23:03:56,997 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc2, Zero weights: 0/10080 (0.00%)
2024-03-20 23:03:56,997 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc3, Zero weights: 0/840 (0.00%)
2024-03-20 23:03:56,997 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv1, Zero weights: 43/54 (79.63%)
2024-03-20 23:03:56,998 - analyzer.measurement.sparseMeasurement - INFO - Module: model.conv2, Zero weights: 432/864 (50.00%)
2024-03-20 23:03:56,998 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc1, Zero weights: 37632/94080 (40.00%)
2024-03-20 23:03:56,999 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc2, Zero weights: 6048/10080 (60.00%)
2024-03-20 23:03:56,999 - analyzer.measurement.sparseMeasurement - INFO - Module: model.fc3, Zero weights: 0/840 (0.00%)
2024-03-20 23:03:56,999 - analyzer.analyzer - CRITICAL - row labels amount
2024-03-20 23:03:57,000 - analyzer.analyzer - CRITICAL - ['model.conv1', 'model.conv2', 'model.fc1', 'model.fc2', 'model.fc3']
2024-03-20 23:03:59,427 - analyzer.analyzer - INFO - 
Test set: Average loss: 0.0015, Accuracy: 9873/10000 (99%)
2024-03-20 23:04:01,088 - analyzer.analyzer - INFO - 
Test set: Average loss: 0.0015, Accuracy: 9873/10000 (99%)
2024-03-20 23:04:02,747 - analyzer.analyzer - INFO - 
Test set: Average loss: 0.0015, Accuracy: 9873/10000 (99%)
